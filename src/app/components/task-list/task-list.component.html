<div class="container mx-auto my-4">

  <!-- Top navigation -->
  <div class="flex flex-wrap justify-between items-center mb-4 gap-2">
    
    <!-- Dashboard title -->
    <h2 class="text-2xl font-bold">Task Manager Dashboard</h2>
    <div class="flex gap-4 items-center">
      <a 
        routerLink="/fileTree" 
        class="text-blue-600 hover:text-blue-800 font-medium px-3 py-1 rounded hover:bg-blue-100"
      >
        File Tree
      </a>
      <a 
        routerLink="/tasks" 
        class="text-blue-600 hover:text-blue-800 font-medium px-3 py-1 rounded hover:bg-blue-100"
      >
        Dashboard
      </a>
    </div>

    <button 
      class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2"
      (click)="onAddNewTask()"
    >
      <i class="fas fa-plus"></i> Add Task
    </button>

  </div>

  <div class="flex flex-wrap gap-3 mb-4">
    <input
      type="text"
      class="border border-gray-300 rounded px-3 py-2 flex-1"
      placeholder="Search by title or description"
      [formControl]="searchControl"
    />

    <select
      class="border border-gray-300 rounded px-3 py-2"
      [(ngModel)]="statusFilter"
      (change)="onStatusFilterChange(statusFilter)"
    >
      <option value="All">All Statuses</option>
      <option *ngFor="let status of ['To Do', 'In Progress', 'Complete']" [value]="status">
        {{ status }}
      </option>
    </select>

    <div class="flex items-center gap-2 flex-wrap">
      <span class="font-medium">Sort By:</span>
      <button
        class="border border-gray-300 rounded px-2 py-1 text-sm hover:bg-gray-100"
        [class.font-bold]="sortField === 'createdDate'"
        (click)="onSortFieldChange('createdDate')"
      >
        Created Date
        <i
          [class]="
            sortField === 'createdDate'
              ? sortOrder === 'asc'
                ? 'fas fa-arrow-up'
                : 'fas fa-arrow-down'
              : ''
          "
        ></i>
      </button>
      <button
        class="border border-gray-300 rounded px-2 py-1 text-sm hover:bg-gray-100"
        [class.font-bold]="sortField === 'title'"
        (click)="onSortFieldChange('title')"
      >
        Title
        <i
          [class]="
            sortField === 'title'
              ? sortOrder === 'asc'
                ? 'fas fa-arrow-up'
                : 'fas fa-arrow-down'
              : ''
          "
        ></i>
      </button>
    </div>
  </div>

  <div *ngIf="filteredTasks.length === 0" class="text-center mt-5 text-gray-500">
    No tasks found.
  </div>

  <div class="space-y-3">
    <div
      *ngFor="let task of filteredTasks"
      class="bg-white rounded shadow p-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4"
    >
      <div class="flex items-center gap-3">
        <i
          class="fas"
          [ngClass]="getStatusIcon(task.status)"
          [style.color]="getStatusColor(task.status)"
          style="font-size: 1.5rem;"
          title="{{ task.status }}"
        ></i>
        <div>
          <h5 class="font-semibold">{{ task.title }}</h5>
          <p class="text-gray-600 truncate max-w-xs">{{ task.description }}</p>
        </div>
      </div>
      <div class="flex flex-col md:flex-row gap-3 text-gray-500 text-sm items-start md:items-center">
        <div><strong>Created:</strong> {{ task.createdDate | date:'mediumDate' }}</div>
        <div><strong>Due:</strong> {{ task.dueDate | date:'mediumDate' }}</div>
        <button
          class="border border-blue-500 text-blue-500 px-2 py-1 rounded hover:bg-blue-50"
          (click)="onEditTask(task)"
        >
          Edit
        </button>
      </div>
    </div>
  </div>
</div>
<app-task-form
  [task]="selectedTask"
  [isOpen]="isModalOpen"
  (close)="onModalClose()"
  (save)="onSaveTask($event)"
></app-task-form>
